# LLM-based_CAMD
Python algorithm implementation for LLM-based Cryptographic API Misuse Detection, featuring both standard prompt and CoT prompt templates for LLMs. It supports single code file detection and debugging, as well as batch detection for folders. Batch folder detection outputs the results in a CSV-formatted table.
1. **Environment Setup:**
   - It is recommended to use **Python 3.10** as the runtime environment in PyCharm. Before executing either the batch detection or single file detection programs, please install the required dependency modules listed in `requirements.txt` using the `pip install module_name` command.
2. **Batch Detection Programs:**
   - `Batch_Cryptographic_API_Misuse_Detection-with_CoT.py` is the batch detection program **with Chain-of-Thought (CoT) prompting**.
   - `Batch_Cryptographic_API_Misuse_Detection-without_CoT.py` is the batch detection program **without Chain-of-Thought (CoT) prompting**.
     **Important:** Insert your own **SiliconFlow API Key** into the program before running it. If you don't have a key, you can apply for and create one at <https://cloud.siliconflow.cn/me/models>.
3. **Test Case Folders & Batch Execution:**
   - The `py_full_unsafe` folder contains **228 vulnerability test cases** sourced from PyCryptoBench.
   - The `pysafe_trapfile` folder contains **804 trap test cases** sourced from PyCryptoBench.
     Executing a batch detection program will perform detection on all code files within these two folders. The detection results will be saved to a CSV file.
4. **Detection Results:**
   - The `Detection_Result_CSV` folder stores the output CSV files containing the detection results generated by the batch detection programs.
5. **Rule File:**
   - The `rule_source.py` file contains the rule definition files used by the detection system.
6. **Single File Detection:**
   - The `Single_file_Dection` folder contains the program for detecting cryptographic API misuse in **individual code files**. This can be used for:
     - Performing **supplementary detection** on anomalous results identified during batch detection.
     - **Debugging** code during development.
